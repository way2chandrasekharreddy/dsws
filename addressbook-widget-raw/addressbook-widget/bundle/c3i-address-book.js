!function(n,t,f){function e(e,i,s,n){return{scope:{},replace:!0,template:'<div class="neo-widget widget--c3i-address-book">\n\n    <div class="neo-widget__header aoc-agents">C3i Address Book</div>\n\n    <div class="neo-widget__content">\n\n        <div class="c3i-address-book-content" ng-show="!editingContact && !openedContact" layout="column">\n\n            <md-content style="min-height: 70px;">\n\n                <div class="supervisor-info" layout="row" layout-align="space-between center" >\n\n                    <span>Please choice contact list</span>\n\n                    <md-select ng-model="supervisorsData.selectedSupervisor"\n\n                              class="md-no-underline"\n\n                               ng-change="updateContactList()">\n\n                        <md-option ng-value="supervisor"\n\n                                   ng-repeat="supervisor in supervisorsData.supervisors">\n\n                            {{ supervisor}}\n\n                        </md-option>\n\n                    </md-select>\n\n                </div>\n\n             \x3c!--    <div class="supervisor-info" layout="row" layout-align="space-between center"\n\n                     ng-if="role !==\'SUPER_ADMIN\'">\n\n                    <span>Your supervisor is {{ supervisorsData.selectedSupervisor.firstName ? supervisorsData.selectedSupervisor.firstName + \' \' + supervisorsData.selectedSupervisor.lastName : supervisorsData.selectedSupervisor.supervisorHandle }}.</span>\n\n                </div> --\x3e\n\n                <div layout="row">\n\n                    <md-input-container md-no-float class="md-block cc-input search-box aoc-search" flex>\n\n                        <input placeholder="{{ \'Search Contacts\' }}" ng-model="contactsSearch"\n\n                               ng-change="filterContacts()" aria-label="Search Contacts" md-autofocus cc-focus>\n\n                    </md-input-container>\n\n                </div>\n\n            </md-content>\n\n            <md-content class="contact-list" flex cc-scrollbar>\n\n                <md-table-container>\n\n                    <table md-table md-progress="contactsGettingPromise">\n\n                        <thead md-head md-order="orderBy">\n\n                        <tr md-row>\n\n                            <th md-column></th>\n\n                            <th md-column md-order-by="firstname">First name</th>\n\n                            <th md-column md-order-by="lastname">Last name</th>\n\n                            <th md-column>\n\n                                <md-button class="md-icon-button" ng-click="updateContactList()"\n\n                                           aria-label="Click to refresh contact list" cc-tooltip>\n\n                                    <md-icon class="aoc-refresh"></md-icon>\n\n                                </md-button>\n\n                            </th>\n\n                        </tr>\n\n                        </thead>\n\n                        <tbody md-body>\n\n                        <tr md-row\n\n                            ng-repeat="contact in contacts | orderBy: orderBy | filter: contactsSearch track by $index">\n\n                            <td md-cell ng-click="openContact(contact)">\n\n                                <cc-text-avatar text="contact.firstname + \' \' + contact.lastname"></cc-text-avatar>\n\n                            </td>\n\n                            <td md-cell ng-click="openContact(contact)">{{contact.firstname}}</td>\n\n                            <td md-cell ng-click="openContact(contact)">{{contact.lastname}}</td>\n\n                            <td md-cell>\n\n                                <div ng-if="role !== \'AGENT\' || contact.createdby===userConfiguration.handle">\n\n                                    <md-button class="md-icon-button" ng-click="editContact(contact.contactId)"\n\n                                               aria-label="Click to edit {{ contact.firstname + \' \' + contact.lastname }}"\n\n                                               cc-tooltip>\n\n                                        <md-icon class="aoc-edit"></md-icon>\n\n                                    </md-button>\n\n                                    <md-button class="md-icon-button" ng-click="showDeleteConfirm($event, contact)"\n\n                                               aria-label="Click to delete {{ contact.firstname + \' \' + contact.lastname }}"\n\n                                               cc-tooltip>\n\n                                        <md-icon class="aoc-end"></md-icon>\n\n                                    </md-button>\n\n                                </div>\n\n                            </td>\n\n                        </tr>\n\n                        <tr md-row ng-if="!contacts || contacts.length===0">\n\n                            <td md-cell colspan="4">\n\n                                <div class="content--empty aoc-agents">\n\n                                    <p>No contacts to display</p>\n\n                                </div>\n\n                            </td>\n\n                        </tr>\n\n                        </tbody>\n\n                    </table>\n\n                </md-table-container>\n\n            </md-content>\n\n            <md-content style="min-height: 40px;" layout="row" layout-align="center none">\n\n                <md-button class="md-icon-button" ng-click="addContact()" aria-label="{{ \'Click for add new contact\' }}"\n\n                        cc-tooltip>\n\n                    <md-icon class="aoc-add"></md-icon>\n\n                </md-button>\n\n            </md-content>\n\n        </div>\n\n        <div class="c3i-address-book-content" ng-if="editingContact" layout="column">\n\n            <md-content class="contact-edit" cc-scrollbar>\n\n                    <md-input-container md-no-float class="md-block cc-input" flex>\n\n                        <label>First name:</label>\n\n                        <input ng-model="editingContact.firstname" name="firstname">\n\n                    </md-input-container>\n\n                    <md-input-container md-no-float class="md-block cc-input" flex>\n\n                        <label>Last name:</label>\n\n                        <input ng-model="editingContact.lastname" name="lastname">\n\n                    </md-input-container>\n\n                    <md-input-container md-no-float class="md-block cc-input" flex>\n\n                        <label>Phone:</label>\n\n                        <input ng-model="editingContact.phone" name="phone">\n\n                    </md-input-container>\n\n                    <md-input-container md-no-float class="md-block cc-input" flex>\n\n                        <label>Extension:</label>\n\n                        <input ng-model="editingContact.extension" name="extension">\n\n                    </md-input-container>\n\n                    <md-input-container md-no-float class="md-block cc-input" flex>\n\n                        <label>Email address:</label>\n\n                        <input ng-model="editingContact.email" name="email">\n\n                    </md-input-container>\n\n                   <md-input-container md-no-float class="md-block cc-input" flex>\n\n                        <label>Organization:</label>\n\n                        <md-select ng-model="editingContact.organization" placeholder="Organization" name="organization">\n\n                        <md-option ng-value="supervisorsData.supervisors[$index]"\n\n                                   ng-repeat="org in supervisorsData.supervisors track by $index">\n\n                                {{::org }}\n\n                        </md-option>\n\n                    </md-select>\n\n                </md-input-container> \n\n            </md-content>\n\n            <md-content layout="row" layout-align="end none">\n\n                <md-button ng-if="!editingContact.contactId" class="md-icon-button" ng-click="createContact()"\n\n                           aria-label="{{ \'Click to create changes\' }}" cc-tooltip>\n\n                    <md-icon class="aoc-accept"></md-icon>\n\n                </md-button>\n\n                <md-button ng-if="editingContact.contactId" class="md-icon-button" ng-click="saveContact()"\n\n                           aria-label="{{ \'Click to save changes\' }}" cc-tooltip>\n\n                    <md-icon class="aoc-accept"></md-icon>\n\n                </md-button>\n\n                <md-button class="md-icon-button" ng-click="cancelEditing()"\n\n                           aria-label="{{ \'Click to cancel contact editing\' }}" cc-tooltip>\n\n                    <md-icon class="aoc-end"></md-icon>\n\n                </md-button>\n\n            </md-content>\n\n        </div>\n\n\n\n        <div class="c3i-address-book-content" ng-if="openedContact" layout="column">\n\n            <md-content class="contact-details" cc-scrollbar>\n\n                <md-input-container md-no-float class="md-block cc-input" flex>\n\n                    <label>Firstname:</label>\n\n                    <input ng-model="openedContact.firstname" ng-disabled="true">\n\n                </md-input-container>\n\n                <md-input-container md-no-float class="md-block cc-input" flex>\n\n                    <label>Lastname:</label>\n\n                    <input ng-model="openedContact.lastname" ng-disabled="true">\n\n                </md-input-container>\n\n                <md-input-container md-no-float class="md-block cc-input" flex>\n\n                    <label>Phone:</label>\n\n                    <input ng-model="openedContact.phone" ng-disabled="true">\n\n                </md-input-container>\n\n                <md-input-container md-no-float class="md-block cc-input" flex>\n\n                    <label>Extension:</label>\n\n                    <input ng-model="openedContact.extension" ng-disabled="true">\n\n                </md-input-container>\n\n                <md-input-container md-no-float class="md-block cc-input" flex>\n\n                    <label>Emailaddress:</label>\n\n                    <input ng-model="openedContact.email" ng-disabled="true">\n\n                </md-input-container>\n\n                <md-input-container md-no-float class="md-block cc-input" flex>\n\n                    <label>Organization:</label>\n\n                    <input ng-model="openedContact.organization" ng-disabled="true">\n\n                </md-input-container>\n\n            </md-content>\n\n            <md-content layout="row" layout-align="end none">\n\n                <md-button class="md-icon-button" ng-click="closeContact()"\n\n                           aria-label="{{ \'Click to close contact details\' }}" cc-tooltip>\n\n                    <md-icon class="aoc-end"></md-icon>\n\n                </md-button>\n\n            </md-content>\n\n        </div>\n\n    </div>\n\n</div>\n\n',link:function(a,n,t){var o=new e(t);a.userConfiguration=o.getConfiguration();var c=s.start(a.userConfiguration.token,a.userConfiguration.handle);JSON.parse(localStorage.getItem("_cc.user")),a.contacts=[],a.role="AGENT",a.supervisorsData={supervisors:[],selectedSupervisor:""},c.getUserRole().then(function(n){a.role=n.data.role},function(n){a.updateContactList(),console.warn("[C3I-ADDRESS-BOOK-WIDGET] Request for getting agent role failed",n),o.sendNotification("error","Request for getting agent role failed")}),c.getSupervisors(a.role).then(function(n){a.supervisorsData.supervisors=n.data.organizationList,a.supervisorsData.selectedSupervisor=n.data.organizationList[0],a.updateContactList()},function(n){console.warn("[C3I-ADDRESS-BOOK-WIDGET] Request for getting current agent supervisor failed",n),o.sendNotification("error","Request for getting current agent supervisor failed")}),a.updateContactList=function(){a.contactsGettingPromise=c.getContacts(a.supervisorsData.selectedSupervisor).then(function(n){a.contacts=n.data.contactList},function(n){console.warn("[C3I-ADDRESS-BOOK-WIDGET] Request for getting contacts failed",n),o.sendNotification("error","Request for getting contacts failed")})},a.editContact=function(n){c.getContact(n).then(function(n){a.editingContact=n.data.contactList[0]},function(n){console.warn("[C3I-ADDRESS-BOOK-WIDGET] Request for getting contact failed",n),o.sendNotification("error","Request for getting contact failed")})},a.openContact=function(n){c.getContact(n.contactId).then(function(n){a.openedContact=n.data.contactList[0]},function(n){console.warn("[C3I-ADDRESS-BOOK-WIDGET] Request for getting contact failed",n),o.sendNotification("error","Request for getting contact failed")})},a.closeContact=function(){a.openedContact=f},a.showDeleteConfirm=function(n,t){var e=i.confirm().title("Delete confirmation").textContent("Are you sure you want to delete contact "+t.firstname+" "+t.lastname+"?").targetEvent(n).ok("Delete").cancel("Cancel");i.show(e).then(function(){c.deleteContact(t.contactId).then(function(){a.updateContactList()},function(n){console.warn("[C3I-ADDRESS-BOOK-WIDGET] Request for deleting contact failed",n),o.sendNotification("error","Request for deleting contact failed")})},function(){})},a.addContact=function(){a.editingContact=c.getEmptyContact(),a.editingContact.organization=a.supervisorsData.selectedSupervisor},a.cancelEditing=function(){a.editingContact=f},a.saveContact=function(){c.updateContact(a.editingContact).then(function(){a.editingContact=f,a.updateContactList()},function(n){console.warn("[C3I-ADDRESS-BOOK-WIDGET] Request for updating contact failed",n),o.sendNotification("error","Request for updating contact failed")})},a.createContact=function(){c.addContact(a.editingContact).then(function(){a.editingContact=f,a.updateContactList()},function(n){console.warn("[C3I-ADDRESS-BOOK-WIDGET] Request for adding contact failed",n),o.sendNotification("error","Request for adding contact failed")})},n.on("$destroy",function(){o.unregister()})}}}function a(o){var e=12;function t(n){var a=o.defer();return setTimeout(function(){var t=[],e=n||p[0].supervisorHandle;u.forEach(function(n){n.supervisor===e&&t.push(n)}),a.resolve({data:{contactList:t}})},3e3),a.promise}function a(t){var e=o.defer();return setTimeout(function(){var n=u.findIndex(function(n){return n.contactId===t});e.resolve({data:{contactList:[u[n]]}})},1e3),e.promise}function c(n){var t=o.defer();return setTimeout(function(){n.contactId=e++,n.createdby="agent1@avaya.com",n.supervisor="sup1@avaya.com",u.push(n),t.resolve()},1e3),t.promise}function i(t){var e=o.defer();return setTimeout(function(){var n=u.find(function(n){return n.contactId===t.contactId});n&&(n=t),e.resolve()},1e3),e.promise}function s(t){var e=o.defer();return setTimeout(function(){var n=u.findIndex(function(n){return n.contactId===t});n!==f&&u.splice(n,1),e.resolve()},1e3),e.promise}function r(){var n=o.defer();return setTimeout(function(){n.resolve({data:{role:"AGENT"}})},1e3),n.promise}function d(){var n=o.defer();return setTimeout(function(){n.resolve({data:{supervisorList:[p[0]]}})},1e3),n.promise}function l(){var n=o.defer();return setTimeout(function(){n.resolve({data:{supervisorList:p}})},1e3),n.promise}function m(){return{firstname:"",lastname:"",phone:"",extension:"",email:""}}var u=[{contactId:0,firstname:"Bill",lastname:"Withers",phone:"052254785",extension:"4132",sort_as:"firstname",email:"bWithers@avaya.com",createdby:"agent1@avaya.com",supervisor:"sup1@avaya.com"},{contactId:1,firstname:"Morty",lastname:"Smith",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"agent1@avaya.com",supervisor:"sup1@avaya.com"},{contactId:2,firstname:"Lincoln",lastname:"Smith",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"agent1@avaya.com",supervisor:"sup1@avaya.com"},{contactId:3,firstname:"Tomas",lastname:"Anderson",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"agent1@avaya.com",supervisor:"sup1@avaya.com"},{contactId:4,firstname:"Jacob",lastname:"Miller",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"anotherAgent",supervisor:"sup1@avaya.com"},{contactId:5,firstname:"James",lastname:"Brown",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"anotherAgent",supervisor:"sup1@avaya.com"},{contactId:6,firstname:"Gideon",lastname:"Williams",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"agent1@avaya.com",supervisor:"sup2@avaya.com"},{contactId:7,firstname:"Blake",lastname:"Johnson",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"anotherAgent",supervisor:"sup2@avaya.com"},{contactId:8,firstname:"Benjamin",lastname:"Smith",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"anotherAgent",supervisor:"sup2@avaya.com"},{contactId:9,firstname:"Emmett",lastname:"Walker",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"anotherAgent",supervisor:"sup2@avaya.com"},{contactId:10,firstname:"Christopher",lastname:"Ronaldson",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"agent1@avaya.com",supervisor:"sup2@avaya.com"},{contactId:11,firstname:"Declan",lastname:"King",phone:"0565874541",extension:"4133",sort_as:"firstname",email:"mSmith@avaya.com",createdby:"agent1@avaya.com",supervisor:"sup2@avaya.com"}],p=[{firstName:"sup1",lastName:"sup1",supervisorHandle:"sup1@avaya.com"},{firstName:"sup2",lastName:"sup2",supervisorHandle:"sup2@avaya.com"}];return{start:function(n){return n?{getContacts:t,getContact:a,addContact:c,updateContact:i,deleteContact:s,getEmptyContact:m,getUserRole:r,getSupervisor:d,getSupervisors:l}:f}}}function o(t){var e,a,o=localStorage.getItem("_cc.libraryUrl")+"/services/C3i-Addressbook/ws/";function c(n){return t({url:o+"contacts"+(n?"/"+n:""),method:"GET",headers:{Authorization:e},params:{agentHandle:a}})}function i(n){return t({url:o+"contact/"+n,method:"GET",headers:{Authorization:e},params:{agentHandle:a}})}function s(n){return t({url:o+"contact",method:"POST",headers:{Authorization:e},params:{agentHandle:a},data:n})}function r(n){return t({url:o+"contact",method:"PUT",headers:{Authorization:e},params:{agentHandle:a},data:n})}function d(n){return t({url:o+"contact/"+n,method:"DELETE",headers:{Authorization:e},params:{agentHandle:a}})}function l(){return t({url:o+"agentrole",method:"GET",headers:{Authorization:e},params:{agentHandle:a}})}function m(){return t({url:o+"supervisor",method:"GET",headers:{Authorization:e},params:{agentHandle:a}})}function u(n){return t({url:o+"organizations/"+n,method:"GET",headers:{Authorization:e},params:{agentHandle:a}})}function p(){return{firstname:"",lastname:"",phone:"",extension:"",email:"",organization:""}}return{start:function(n,t){return n?(e=n,a=t,{getContacts:c,getContact:i,addContact:s,updateContact:r,deleteContact:d,getEmptyContact:p,getUserRole:l,getSupervisor:m,getSupervisors:u}):f}}}e.$inject=["WidgetAPI","$mdDialog","AddressBookService","$timeout"],t.module("45d4feef-f97b-4926-ac50-e7e19d232351",["core.services.WidgetAPI"]).directive("c3iAddressBook",e),a.$inject=["$q"],t.module("45d4feef-f97b-4926-ac50-e7e19d232351").factory("AddressBookServiceTEST",a),o.$inject=["$http"],t.module("45d4feef-f97b-4926-ac50-e7e19d232351").factory("AddressBookService",o)}(window,window.angular);